- !Meta
  description: |
    Project command-line interface

- !ShellCommand
  name: app echo
  description: Echo greeting
  image: env
  params:
    - !Argument {name: name, default: World}
  shell: echo "Hello {{name}}!!!"

- !SubCommand
  name: ping
  image: !DockerImage ubuntu:trusty
  call: ping

- !SubCommand
  name: shell
  image: !DockerImage ubuntu:xenial
  call: /bin/bash
  volumes:
  - !LocalPath { from: ".", to: "/dst", mode: !RW }
  ports:
  - !Expose { port: 8000, as: 8080 }

- !Image
  name: env
  repository: reg.local/env
  provision-with: !Dockerfile Dockerfile.env

- !Image
  name: app.env
  from: env
  repository: reg.local/app.env
  provision-with: !AnsibleTasks
    - file: path=/foo.ini state=touch
