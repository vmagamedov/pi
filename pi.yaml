- !Meta
  description: |
    Project command-line interface

- !Image
  name: test-py35
  from: !DockerImage python:3.5.3-alpine
  repository: reg.local/pi/test-py35
  tasks:
  - run: >
      pip3 install --no-cache-dir --disable-pip-version-check
      {{packages|join(" ")}}
    packages:
    - aiohttp==1.0.5
    - pytest==3.0.5
    - pytest-asyncio==0.5.0
    - flake8==3.2.1

- !Image
  name: docs
  from: !DockerImage python:3.5.3-alpine
  repository: reg.local/pi/docs
  tasks:
  - run: >
      pip3 install --no-cache-dir --disable-pip-version-check
      {{packages|join(" ")}}
    packages:
    - sphinx==1.4.8
    - sphinx_rtd_theme==0.1.10a0

- !SubCommand
  name: test
  image: test-py35
  run: py.test

- !SubCommand
  name: lint
  image: test-py35
  run: flake8

- !ShellCommand
  name: build docs
  image: docs
  run: sphinx-build -b html docs build
